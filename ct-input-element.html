<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-input/paper-textarea.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../ct-editable-switcher/ct-editable-switcher.html">
<!--
`ct-input-element`
A element that display and edits a centular input

@demo demo/index.html
-->

<dom-module id="ct-input-element">
  <template>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <style is="custom-style">
            :host {
                --paper-input-error: {
                    color:#00ff00;
                };
                --paper-input-container:  {
                    border-top:1px solid #ccc;
                    border-left:1px solid #ccc;
                    border-right:1px solid #ccc;
                    border-bottom: none;
                    padding: 0;
                    margin-bottom: 24px;
                };
                /*padding to move from border */
                --paper-input-container-input: {
                    padding-left: 10px;
                    left: auto;
                };
                --paper-input-container-label: {
                    margin-left: 10px;
                };
                --paper-input-container-label-floating: {
                    margin-left: 10px;
                };
                --paper-input-error: {
                    left: auto !important;
                    right: 20px !important;
                    font-style: italic;
                };
                --paper-icon-button-ink-color: var(--breadcrumb-icon-color-ripple);
            }
            /* local color for button */
            paper-button.fancy {
                margin-top: 3px;
            }
            /*local dropdown menu */
            paper-dropdown-menu.custom-dropdown {
                width: 100%;
                --paper-input-container: {
                    border-top:1px solid #ccc;
                    border-left:1px solid #ccc;
                    border-right:1px solid #ccc;
                    border-bottom: none;
                    padding: 0;
                    margin-bottom: 8px;
                };
                --paper-input-container-input: {
                    padding-left: 10px;
                };
            }
            .primary-box-container {
                background: #3d3d3d;
                margin-bottom: 40px;
            }
            .primary-box-container h3 {
                color: #ffffff;
                margin: 10px 0;
            }
            .breadcrumb-icon {
                --paper-icon-button-ink-color: {#fff !important;};
            }
            .main-section .primary-box-container h3 {
                font-size: 20px;
                line-height: 21px;
                padding: 0 15px;
            }
        </style>

    <div class="row row-easy">
          <div class="col-xs-8 col-sm-10">
               <template is="dom-if"  restamp if="{{ _isInputType('textarea', inputType)}}">
                 <ct-editable-switcher edit-mode$="[[_isStateEdit]]">

                     <paper-textarea
                            id='input'
                            class="input-element"
                            label = "[[label]]"
                            value = "[[value]]"
                            disabled = "[[disabled]]"
                            invalid = "[[invalid]]"
                            allowedPattern = "[[allowedPattern]]"
                            type = "[[type]]"
                            list = "[[list]]"
                            pattern = "[[pattern]]"
                            required = "[[required]]"
                            errorMessage ="[[errorMessage]]"
                            charCounter = "[[charCounter]]"
                            noLabelFloat ="[[noLabelFloat]]"
                            alwaysFloatLabel ="[[alwaysFloatLabel]]"
                            autoValidate = "[[autoValidate]]"
                            validator = "[[validator]]"
                            autocomplete = "[[autocomplete]]"
                            autofocus = "[[autofocus]]"
                            inputmode = "[[inputmode]]"
                            minlength = "[[minlength]]"
                            min = "[[min]]"
                            max = "[[max]]"
                            step = "[[step]]"
                            name = "[[name]]"
                            placeholder = "[[placeholder]]"
                            readonly = "[[readonly]]"
                            size = "[[size]]"
                            autocapitalize = "[[autocapitalize]]"
                            autocorrect = "[[autocorrect]]"
                            autosave = "[[autosave]]"
                            results = "[[results]]"
                            accept = "[[accept]]"
                            multiple = "[[multiple]]"
                            error-message="[[errorMessage]]">
                            <div suffix class="input-suffix"> [[suffix]]</div>
                          </paper-textarea>
                  </ct-editable-switcher>
              </template>

              <template is="dom-if" restamp if="{{_isInputType('text', inputType) }}">
                  <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
                    <paper-input
                    id='input'
                    class="input-element"
                    label = "[[label]]"
                    value = "[[value]]"
                    disabled = "[[disabled]]"
                    invalid = "[[invalid]]"
                    allowedPattern = "[[allowedPattern]]"
                    type = "text"
                    list = "[[list]]"
                    pattern = "[[pattern]]"
                    required = "[[required]]"
                    errorMessage ="[[errorMessage]]"
                    charCounter = "[[charCounter]]"
                    noLabelFloat ="[[noLabelFloat]]"
                    alwaysFloatLabel ="[[alwaysFloatLabel]]"
                    autoValidate = "[[autoValidate]]"
                    validator = "[[validator]]"
                    autocomplete = "[[autocomplete]]"
                    autofocus = "[[autofocus]]"
                    inputmode = "[[inputmode]]"
                    minlength = "[[minlength]]"
                    min = "[[min]]"
                    max = "[[max]]"
                    step = "[[step]]"
                    name = "[[name]]"
                    placeholder = "[[placeholder]]"
                    readonly = "[[readonly]]"
                    size = "[[size]]"
                    autocapitalize = "[[autocapitalize]]"
                    autocorrect = "[[autocorrect]]"
                    autosave = "[[autosave]]"
                    results = "[[results]]"
                    accept = "[[accept]]"
                    multiple = "[[multiple]]"
                    error-message="[[errorMessage]]">
                    <div suffix class="input-suffix"> [[suffix]]</div>
                  </paper-input>
                  </ct-editable-switcher>
              </template>

              <template is="dom-if" restamp if="{{_isInputType('number', inputType) }}">
                <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
                  <paper-input
                  id='input'
                  class="input-element"
                  label = "[[label]]"
                  value = "[[value]]"
                  disabled = "[[disabled]]"
                  invalid = "[[invalid]]"
                  allowedPattern = "[[allowedPattern]]"
                  type = "number"
                  list = "[[list]]"
                  pattern = "[[pattern]]"
                  required = "[[required]]"
                  errorMessage ="[[errorMessage]]"
                  charCounter = "[[charCounter]]"
                  noLabelFloat ="[[noLabelFloat]]"
                  alwaysFloatLabel ="[[alwaysFloatLabel]]"
                  autoValidate = "[[autoValidate]]"
                  validator = "[[validator]]"
                  autocomplete = "[[autocomplete]]"
                  autofocus = "[[autofocus]]"
                  inputmode = "[[inputmode]]"
                  minlength = "[[minlength]]"
                  min = "[[min]]"
                  max = "[[max]]"
                  step = "[[step]]"
                  name = "[[name]]"
                  placeholder = "[[placeholder]]"
                  readonly = "[[readonly]]"
                  size = "[[size]]"
                  autocapitalize = "[[autocapitalize]]"
                  autocorrect = "[[autocorrect]]"
                  autosave = "[[autosave]]"
                  results = "[[results]]"
                  accept = "[[accept]]"
                  multiple = "[[multiple]]"
                  error-message="[[errorMessage]]">
                  <div suffix class="input-suffix"> [[suffix]]</div>
                </ct-editable-switcher>
              </template>


              <template is="dom-if" restamp if="[[_isInputType('boolean', inputType)]]">
                <ct-editable-switcher edit-mode$="[[_isStateEdit]]">
                  [[label]]
                  <paper-toggle-button
                          id='input'
                          class="input-element"
                          required="[[required]]"
                          checked="[[_isTrue(value)]]"></paper-toggle-button>
                          <div suffix class="input-suffix"> [[suffix]]</div>
                </ct-editable-switcher>
              </template>

              <template is="dom-if" restamp if="[[_checkNote(note)]]">
                <small>[[note]]</small>
            </template>
            </div>
            <div class="col-xs-4 col-sm-2">
            <div class="text-center">
                <paper-icon-button icon="create" class="table-button btn-default btn-sm" on-tap="_editHandler" raised></paper-icon-button>
                <paper-icon-button icon="delete"  data-item-id$="[[item.id]]" class="table-button btn-danger btn-sm" on-tap="_deleteHandler" raised></paper-icon-button>
            </div>
          </div>
        </div>

  </template>

  <script>
    Polymer({

      is: 'ct-input-element',

      properties: {
        inputType: {
            type: String
        },
        note: {
            type: String
        }
      },
      behaviors: [
        Polymer.PaperInputBehavior
      ],
      _isInputType: function(expectedType, type){
        return expectedType === type;
      },
      _checkNote : function(note){
        return note != "";
      },
      _deleteHandler : function(e){
        this.fire('delete', e);
      },
      _editHandler : function(e){
          var input = this.$$('#input');
          if(this._isStateEdit){
              if(input.validate()){
                  this._submitHandler(e);
              }
          } else {
              this._toggleStatus(e);
          }
      },
      _isTrue: function(value){
          return value === "true";
      },
      _submitHandler : function(e){
        var input = this.$$('#input');
          e.preventDefault();

          this.fire('edit', input.value);
          this._toggleStatus();
      },
      _computeButtonText: function(isEdit){
          return (isEdit) ? 'Save Details' : 'Edit Details';
      },

      _computeBtnStyle : function(isEdit){
          return (isEdit) ? "btn-success" : "btn-primary";
      },

      _toggleStatus : function(){
          this._isStateEdit = !this._isStateEdit;
      },
    });
  </script>
</dom-module>
